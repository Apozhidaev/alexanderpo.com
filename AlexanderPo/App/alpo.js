(function(n,t,i,r,u){"use strict";n.createApiObject=function(t){t=t||{};var i=Object.create(t,{api:{value:t}});return n.debug&&(t.__self&&(i.__self=t.__self),t.__self=function(){return i}),i};r.bindingHandlers.render={init:function(){return{controlsDescendantBindings:!0}},update:function(t,i){n.app.render(t,r.unwrap(i()))}};n.Notices={Success:0,Error:1,NotFound:2,UpdateReady:3,SubmitChanges:4};var f=function(){function t(n){var t=this;return!t.frame.canNavigate||t.frame.canNavigate(n)}function i(t){var i=this;t&&t.length&&i.routeMap[t[0]]&&i.canNavigate(t[0])?i.routeMap[t[0]](t.slice(1)):n.app.notice(n.Notices.NotFound)}function r(n,t){var i=this;i.routeMap[n]=t;i.routes.push(n)}function u(){for(var n=this,t=0;t<n.routes.length;t++)if(n.canNavigate(n.routes[t]))return n.routes[t];return null}function f(n){var t=this;return!!t.routeMap[n]}function e(e){var o=n.createApiObject(),s;return o.routes=[],o.routeMap={},o.frame=e.frame,o.canNavigate=t,s=o.api,s.go=i.bind(o),s.add=r.bind(o),s.first=u.bind(o),s.contains=f.bind(o),s}return e}();n.Page=function(){function t(t){var i=this;t=t||{};n.app.navigate({url:t.urn?i.root()+"/"+t.urn:i.root(),replace:t.replace})}function i(t){var i=this;t=t||{};n.app.navigate({url:t.urn?i.url()+"/"+t.urn:i.url(),replace:t.replace})}function f(f){var o=n.createApiObject(f.extend),e;return o.frame=f.frame,o.hasParams=f.hasParams,o.ignoreFrameParams=f.ignoreFrameParams,e=o.api,e.local=f.local,e.config=f.config,e.isViewLoading=r.observable(!1),e.gotoRoot=t.bind(o),e.gotoUrl=i.bind(o),e.isActive=r.pureComputed(function(){return o.frame.content()==e}),o.hasParams&&(e.params=r.observable()),e.config.route&&!o.frame.disableRouting&&o.frame.router.add(e.config.route,function(n){var t={handled:!1};o.hasParams&&(n&&n.length&&(!e.router||!e.router.contains(n[0]))?(t.params=n[0],n=n.slice(1)):t.params=u);t.segments=n;t.navigate=function(){o.hasParams&&e.params(t.params);(e.config.viewUrl||e.config.view)&&o.frame.content()!=e&&o.frame.content(e);e.navigate&&e.navigate(t.segments)};e.beforeNavigate&&e.beforeNavigate(t);t.handled||t.navigate()}),e.config.route&&(e.root=r.pureComputed(function(){if(o.ignoreFrameParams){if(o.frame.root)return o.frame.root()+"/"+e.config.route}else if(o.frame.url)return o.frame.url()+"/"+e.config.route;return e.config.route}),e.url=r.pureComputed(function(){return o.hasParams?e.root()+"/"+e.params():e.root()})),e}return f}();n.Frame=function(){function i(n){var i=this,r;if(!n||!n.length){i.enableDefaultRouting&&(r=i.router.first(),r&&(t.location.href=i.url()+"/"+r));return}i.router.go(n)}function u(t){t=t||{};var e=n.createApiObject(t.extend),u=e.api;return u.config=t.config||u.config,u.content=t.contentObservable||r.observable().extend({rateLimit:1}),u.isPageLoading=r.pureComputed(function(){return u.content()&&u.content().isViewLoading()}),u.disableRouting=t.disableRouting,u.disableRouting||(u.enableDefaultRouting=t.enableDefaultRouting,u.router=f({frame:u}),u.navigate=i.bind(e)),u}return u}();n.App=function(){function f(n){var r=this,t="";return r.viewFolder&&(t+=r.viewFolder),t+=n.viewUrl,i.ajax({url:t,dataType:"html"}).done(function(t){n.view=t})}function e(n){var f=this,r;if(n.config.view!==u)return r=i.Deferred(),r.resolve(n.config.view),r.promise();if(n.config.viewUrl!==u)return n.isViewLoading&&n.isViewLoading(!0),f.loadView(n.config).always(function(){n.isViewLoading&&n.isViewLoading(!1)});throw new t.Error("model.config.view is not found");}function o(n,u){var e=this,f=i.Deferred();return u?t.setTimeout(function(){e.getView(u).done(function(i){r.utils.setHtml(n,i);r.applyBindingsToDescendants(u,n);u.afterRender&&t.setTimeout(function(){u.afterRender()},0)}).fail(function(){r.utils.setHtml(n,"Network error.")}).always(function(){f.resolve()})},0):(r.utils.setHtml(n,""),f.resolve()),f.promise()}function s(n){var r=this,i,u;n?n.replace?t.location.replace(n.url):t.location.href=n.url:(i=t.location.hash,i?(u=i.split("/"),r.model.navigate(u.slice(1))):r.model.navigate())}function h(){var r=this,u=t.applicationCache,f=function(){u.swapCache();n.debug?t.location.reload():n.app.notice(n.Notices.UpdateReady)};u.status==4?f():i(u).bind("updateready",f);r.render(t.document.getElementById(r.appId),r.model).done(function(){i(t).bind("hashchange",function(){r.navigate()});r.navigate()})}function c(n,t){var i=this;i.model.notice(n,t)}function l(t){var i,r;return n.app?n.app:(i=n.createApiObject(t.extend),i.appId=t.appId,i.getView=e,i.loadView=f,i.viewFolder=t.viewFolder,r=i.api,r.model=t.model||r.model,r.run=h.bind(i),r.navigate=s.bind(i),r.render=o.bind(i),r.notice=c.bind(i),n.app=r)}return l}()})(AlPo,window,jQuery,ko),function(){"use strict"}(AlPo,window,jQuery,ko);AlPo.Config=function(n){"use strict";function t(){if(n.config)return n.config;var i=n.createApiObject(),t=i.api;return t.appId="body",t.viewFolder="views/",t.main={viewUrl:"main.html",pages:{loading:{viewUrl:"loading.html"}}},n.config=t}return t}(AlPo);AlPo.LocalStrings.Eng=function(n){"use strict";function t(){var i=n.createApiObject(),t=i.api;return t.main={success:"Well done",error:"Sorry...",notFound:"Not found",updateReady:"New changes available (requires a page refresh)",submitChanges:"Changes have been done",pages:{loading:{loading:"Alexander Pozhidaev"}}},t}return t}(AlPo);AlPo.LocalStrings.Rus=function(n){"use strict";function t(){var i=n.createApiObject(),t=i.api;return t.main={success:"Все хорошо",error:"Ошибка...",notFound:"Не найдено",updateReady:"Новые изменения доступны (требуется обновить страницу)",submitChanges:"Изменения были сохранены",pages:{loading:{loading:"Александр Пожидаев"}}},t}return t}(AlPo);AlPo.ViewModels.LoadingModel=function(n,t,i,r){"use strict";function u(){var t=this;n.app.signOut()}function f(t){var i=n.createApiObject(n.Page(t)),f=i.api;return f.loadingFailed=r.observable(!1),f.signOut=u.bind(i),i.api}return f}(AlPo,window,jQuery,ko);AlPo.ViewModels.Main.NoticeItemModel=function(n,t){"use strict";function i(){var n=this;n.mainModel.notices.remove(n.api);t.clearTimeout(n.infoTimer)}function r(r){var e=n.createApiObject(),f,u;e.mainModel=r.mainModel;f=r.mainModel.local;u=e.api;u.close=i.bind(e);switch(r.type){case n.Notices.Success:u.message=r.message||f.success;u.status="alert-success";break;case n.Notices.Error:u.message=r.message||f.error;u.status="alert-error";break;case n.Notices.NotFound:u.message=r.message||f.notFound;u.status="alert-error";break;case n.Notices.UpdateReady:u.message=r.message||f.updateReady;u.status="alert-warning";break;case n.Notices.SubmitChanges:u.message=r.message||f.submitChanges;u.status="alert-success"}return e.infoTimer=t.setTimeout(u.close,5e3),u}return r}(AlPo,window,jQuery,ko);AlPo.ViewModels.MainModel=function(n,t,i,r){"use strict";function e(){var n=this,t=u.LoadingModel({frame:n.api,local:n.local.pages.loading,config:n.config.pages.loading});n.content(t)}function o(n,t){var i=this;i.notices.push(f.NoticeItemModel({mainModel:i.api,message:t,type:n}))}function s(){var n=this}function h(){var i=n.createApiObject(n.Frame({config:n.config.main,disableRouting:!0})),t=i.api;return t.navigate=e.bind(i),t.notice=o.bind(i),t.clear=s.bind(i),t.notices=r.observableArray(),t.local=n.app.local.main,t}var u=n.ViewModels,f=n.ViewModels.Main;return h}(AlPo,window,jQuery,ko);AlPo.Application=function(n,t){"use strict";function u(){if(t.navigator){if(t.navigator.language)return t.navigator.language;if(t.navigator.browserLanguage)return t.navigator.browserLanguage;if(t.navigator.systemLanguage)return t.navigator.systemLanguage;if(t.navigator.userLanguage)return t.navigator.userLanguage}}function f(){return t.isMobile.phone}function e(t){var r=this,i=this.api;i.notice(n.Notices.Success,t)}function o(t){var r=this,i=this.api;i.notice(n.Notices.Error,t)}function s(){if(n.app)return n.app;n.Config();var s=n.createApiObject(n.App({appId:n.config.appId,viewFolder:n.config.viewFolder})),t=s.api;return t.isMobile=f,/ru/ig.test(u())?(t.local=i.Rus(),t.lang=n.Lang.Rus):(t.local=i.Eng(),t.lang=n.Lang.Eng),t.model=r.MainModel(),t.showSuccess=e.bind(s),t.showError=o.bind(s),t}var i=n.LocalStrings,r=n.ViewModels;return s}(AlPo,window,jQuery)